--- main.c.orig2024-01-01 00:00:00.000000000 +0000
+++ main.c 2024-01-01 00:00:00.000000000 +0000
@@ -163,6 +163,10 @@
 
 if (Mailto == NULL && *optarg == '/') {
 char *buffer = malloc(256);
+if (!buffer) {
+printlogf(LOG_ERR, "malloc failed\n");
+exit(1);
+}
 FILE* file = fopen(optarg, "r");
 if (file) {
 size_t s = fread(buffer, 1, 256, file);
@@ -173,6 +177,8 @@
 Mailto = buffer;
 }
 fclose(file);
+} else {
+free(buffer);
 }
 }
 break;
